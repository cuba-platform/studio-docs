:sourcesdir: ../../../../source

[[data_model_view]]
==== Работа с представлениями
--
{main_man_url}/views.html[Представление] или view - это описание графа объектов, определяющее, какие атрибуты, коллекции и под-сущности должны быть загружены из базы данных при загрузке конкретной сущности. Представления могут быть определены прямо в дескрипторах экрана, или же они могут быть определены отдельно в файле `views.xml` и использоваться повторно в коде приложения.

Для создания нового общего представления, выберите сущность в дереве проекта и нажмите *New > View* в её контекстном меню.

image::features/data_model/create_view.png[align="center"]

В открывшемся диалоге создания представления можно увидеть следующие поля:

* *Entity name* - имя сущности, для которой создаётся представление.
* *Name* - имя нового представления.
* *Extends* - встроенное или собственное представление, чьи атрибуты будет наследовать новое представление. Для любой сущности в платформе определены следующие представления по умолчанию:
** `_local`  включает в себя все локальные атрибуты сущности, т.е. атрибуты, которые не содержат ссылок на другие сущности,
** `_minimal` включает в себя атрибуты, входящие в имя экземпляра сущности и задаваемые аннотацией `@NamePattern`,
** `_base` включает в себя все локальные несистемные атрибуты и атрибуты, заданные в аннотации `@NamePattern` (т.е. фактически `_minimal` + `_local`).
* *Configuration file* - {main_man_url}/views.xml.html[файл конфигурации представлений], в котором будет сохранено текущее представление. По умолчанию Studio создаёт единственный файл `views.xml` в модуле `global`.

Полный список атрибутов выбранной сущности отображается в виде дерева ниже под полями. Вы можете выбрать, какие атрибуты включить в представление, с помощью соответствующих чекбоксов.

Если ваше представление наследует другое представление, все унаследованные атрибуты будут выбраны автоматически, а их чекбоксы будут неактивны.

Когда вы выбираете ссылочный атрибут, в панели справа отобразятся следующие свойства:

* *Entity* - имя сущности, на которую указывает ссылка.
* *View* - необязательное имя представления, с которым должна быть загружена эта сущность. Мы рекомендуем ссылаться на конкретное представление вместо произвольного набора атрибутов, так вам будет проще поддерживать сложные многоуровневые представления. Кроме того, даже если вы указали имя конкретного представления, вы по-прежнему можете добавить к нему отдельные атрибуты, не включённые в это представление, с помощью чекбоксов в дереве атрибутов.
* *Fetch* - дополнительное свойство ссылочных атрибутов, которое определяет тип загрузки связанной сущности из базы данных. Подробнее о типах загрузки см. в {main_man_url}/views.html[основном руководстве].

Когда вы нажмёте *OK* и закроете дизайнер представлений, вы сможете увидеть созданное представление в дереве проекта под сущностью:

image::features/data_model/create_view_2.png[align="center"]
--

[[view_designer]]
Дизайнер представлений::
--
Двойной клик по представлению в дереве проекта откроет файл конфигурации `views.xml` и установит курсор на элементе в списке, соответствующем данному представлению. В нижней части редактора можно увидеть две вкладки: *Text* и *Structure*. Вкладка *Structure* отображает список представлений, описанных в этом файле конфигурации и позволяет визуально сконструировать представление:

image::features/data_model/view_designer.png[align="center"]

Открыть графический дизайнер представлений можно несколькими способами:

* Выбрав представление в дереве проекта, нажать *Edit View* в его контекстном меню;

* Поместив курсов на элемент `view` в коде файла конфигурации представлений, нажать Alt+Enter (Option+Enter), выбрать *Edit view* во всплывающем меню и нажать Enter;

* Переключившись на вкладку *Structure* в редакторе файла конфигурации представлений, выбрать нужное представление и нажать на кнопку *Edit*.

Дизайнер представления позволяет вам безопасно переименовать представление, автоматически изменив все места в коде, которые ссылались на предыдущее название представления и которые можно надёжно определить. Чтобы переименовать представление, нажмите на кнопку "карандаш", расположенную внутри поля ввода *Name* в правой части дизайнера.

[TIP]
====
Дизайнер представлений доступен только пользователям с активной подпиской CUBA Studio.
====
--

[[view_editing]]
Ручное редактирование представлений::
--
Представления также можно редактировать, вручную меняя исходный код файла `views.xml`. Studio предоставляет полноценную поддержку кодинга для XML-структуры конфигурационных файлов представлений.

При редактировании представления в XML-файле используйте автодополнение имён атрибутов с помощью комбинации Ctrl+Space:

image::features/data_model/view_edit_1.png[align="center"]

Обратите внимание, если некоторые атрибуты подсвечены: с большой долей вероятности их не существует в данной сущности:

image::features/data_model/view_edit_2.png[align="center"]
--
