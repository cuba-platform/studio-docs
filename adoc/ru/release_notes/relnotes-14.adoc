[[relnotes_14]]

Версия 14::
+
--
. Добавлена возможность отслеживать изменения схемы БД для дополнительных хранилищ данных  (версия платформы `7.2.0` или выше). Чтобы активировать генерацию скриптов миграции БД для хранилища данных, используйте новую группу переключателей в диалоге *Data Store Properties*:
+
image::release_notes/v-14-add-datastore-mode.png[align="center"]
+
Доступны следующие режимы управления схемой БД:

.. *Disabled* - Studio не отслеживает изменения схемы БД для данного хранилища данных. Это режим по умолчанию, и это то, как работали предыдущие версии Studio.
.. *Update Only* - Studio генерирует *update* скрипты миграции и даёт возможность обновить схему БД, чтобы она соответствовала модели данных. Однако, Studio не предоставляет способа пересоздать базу данных с нуля. Этот режим следует использовать для тех баз данных, которые не управляются полностью CUBA приложением, например для баз данных, которые используются совместно с другими приложениями.
.. *Create and Update* - Studio генерирует полный набор *init* и *update* скриптов миграции БД и предоставляет возможность пересоздать базу данных с нуля или обновить её до соответствия модели данных. Используйте этот режим для баз данных, которые будут полностью управляться CUBA приложением.

. Если в вашем проекте есть дополнительные хранилища данных с включенным управлением схемой БД, то диалог *Database Scripts* будет отображать скрипты миграции БД для всех управляемых хранилищ данных:
+
image::release_notes/v-14-db-scripts-dialog.png[align="center"]
+
Также, диалог *New CUBA Entity* теперь позволяет сразу указать хранилище данных, где сущность должна быть зарегистрирована:
+
image::release_notes/v-14-new-entity-data-store.png[align="center"]

. Добавлен визуальный дизайнер для {main_man_url}/roles.html#roles_design_time[ролей, определяемых во время разработки] (версия платформы `7.2.0` или выше). Он позволяет удобным образом конструировать определения ролей, указывая настройки роли, доступные экраны и пункты меню, CRUD разрешения на сущности, доступные атрибуты и специфические разрешения.
+
image::release_notes/v-14-role-designer.png[align="center"]

. Определения ролей в коде теперь отображаются в дереве проекта CUBA в секции *Security*.
+
image::release_notes/v-14-roles-in-tree.png[align="center"]
+
Чтобы создать новое определение роли, используйте действие контекстного меню -> *New* -> *Role* в секции *Security*:
+
image::release_notes/v-14-new-role.png[align="center"]

. Теперь доступно визуальное редактирование проектной конфигурации {main_man_url}/permissions.xml.html[специфических разрешений]. Этот функционал встроен в визуальный дизайнер ролей и расположен на его вкладке *Specific*:
+
image::release_notes/v-14-specific-permissions.png[align="center"]

. Файлы журналов локального отладочного сервера Tomcat теперь отображаются в секции *Logging* дерева проекта CUBA:
+
image::release_notes/v-14-log-files-in-tree.png[align="center"]

. Добавлена возможность кастомизировать {main_man_url}/logging.html[файл конфигурации журналирования], используемый приложением (версия платформы `7.2.0` или выше). Чтобы создать свой собственный файл конфигурации `logback.xml`, используйте в дереве проекта CUBA -> секция *Logging* -> контекстное меню -> действие *Generate Logback Configuration File*:
+
image::release_notes/v-14-customize-logback.png[align="center"]
+
Скопированный файл можно свободно модифицировать. Он будет использоваться локальным отладочным сервером Tomcat. Он также будет подставляться по умолчанию как файл конфигурации журналов в диалогах *WAR Settings* и *UberJAR Settings*.

. Интеграционные тесты {main_man_url}/integration_tests_mw.html[среднего слоя] и {main_man_url}/integration_tests_client.html[Веб-слоя] теперь отображаются в дереве проекта CUBA, сгруппированные в секции *Business Logic* -> *Tests*:
+
image::release_notes/v-14-tests-in-tree.png[align="center"]

. Добавлена возможность создавать новые классы интеграционных тестов. Чтобы создать новый класс теста, используйте контекстное меню в дереве проекта CUBA -> секция *Tests* -> *New* -> *Integration Test (Middleware)* или *Integration Test (Web)*:
+
image::release_notes/v-14-new-test.png[align="center"]

. Добавлена возможность кастомизировать шаблоны экранов. Чтобы создать собственный шаблон экранов, нажмите кнопку *Copy template* в первом шаге мастера *Create CUBA Screen*. Файлы выбранного шаблона будут скопированы в проект и станут доступны для изменения. Собственные шаблоны экранов отображаются в секции *Generic UI* -> *Screens* -> *Custom Templates* дерева проекта CUBA:
+
image::release_notes/v-14-custom-screen-templates.png[align="center"]
+
Вы можете изменить файлы шаблонов для контроллера и дескриптора экрана или даже добавить новые параметры в мастер, расширив файл *settings.xml*. Пользовательские шаблоны экранов можно выбрать на вкладке *Project Templates* на первом шаге мастера *New* -> *Screen*:
+
image::release_notes/v-14-use-custom-template.png[align="center"]

. В диалог <<middleware_event_listeners,Subscribe to Event>> добавлена возможность генерировать слушатели события {main_man_url}/entityPersistingEvent.html[EntityPersistingEvent]:
+
image::release_notes/v-14-before-persist-event.png[align="center"]

. Диалог *New CUBA Bean* теперь позволяет разработчикам указывать модуль расположения бина и создавать Spring бины в модулях `global`, `web` и `portal` в дополнение к модулю `core`:
+
image::release_notes/v-14-module-in-new-bean.png[align="center"]

. Мастер *Create CUBA Screen* был расширен, туда добавлены шаги для указания представлений (view) браузера и редактора сущности. Теперь разработчик может выбрать желаемый набор свойств прямо в мастере, не открывая модальные диалоги. Выбранные свойства также определяют, какие поля будут отображаться в таблице браузера или редактироваться в форме редактора:
+
image::release_notes/v-14-views-in-screen-wizard.png[align="center"]

. В дизайнер экранов добавлен диалог - мастер создания компонента `Form`. Он активируется, когда разработчик кладет компонент `Form` в верстку экрана. Диалог позволяет выбрать существующий или настроить новый контейнер и указать другие требуемые свойства `Form`:
+
image::release_notes/v-14-form-wizard.png[align="center"]

. Панель дизайнера экранов *Component Palette* теперь позволяет разработчику перетаскивать (drag-and-drop) компоненты из палитры в исходный код. Выбранный компонент будет добавлен как дочерний для конечного тега.

. Переключение главного меню с режима *Composite* на *Single* с целью его кастомизации было упрощено. Дизайнер меню теперь предлагает разработчику скопировать пункты и разделы меню, унаследованные из платформы и аддонов, в конфигурацию проекта.

. В дизайнер сущностей были добавлены дополнительные настройки генерации DDL. Разработчик теперь может выбирать один из трех режимов генерации скриптов базы данных для конкретной сущности: *Create and drop*, *Create only*, *Disabled*. Также теперь возможно указать не-отображенные (unmapped) столбцы или ограничения (которые отсутствуют в модели данных, но созданы в БД, и Studio не должна предлагать удалить их).
+
image::release_notes/v-14-ddl-gen-settings.png[align="center"]

. Функция *Add new attributes to existing screens*, ранее доступная как IntelliJ intention action, была улучшена, и теперь ее проще использовать. Теперь она доступна в исходном коде сущности как кнопка *Add attributes to screens* в верхней панели действий:
+
image::release_notes/v-14-add-attrs-top-action.png[align="center"]
+
image::release_notes/v-14-add-attrs-display.png[align="center"]
+
Похожее действие было добавлено в дизайнер сущностей как кнопка *Add to Screens* над таблицей атрибутов:
+
image::release_notes/v-14-add-attr-entity-designer.png[align="center"]

. Добавлена инспекция, проверяющая использования вызовов `System.out.println` или `System.err.println` в коде. Она предоставляет разработчику быстрые фиксы (доступные по нажатию Alt+Enter / Option+Enter), чтобы преобразовать вызов на использование инжектированного или статического SLF4J логгера:
+
image::release_notes/v-14-sout-logger.gif[align="center"]

. Для инспекции "Entity is created by calling constructor" добавлен быстрый фикс. По нажатию Alt+Enter (Option+Enter) вы можете преобразовать конструкцию на использование рекомендуемого фабричного метода `DataManager#create(Entity.class)`:
+
image::release_notes/v-14-datamanager-create.gif[align="center"]

. Для инспекции "GUI component is created by calling constructor" добавлен быстрый фикс. По нажатию Alt+Enter (Option+Enter) вы можете преобразовать конструкцию на использование рекомендуемого фабричного метода `UiComponents#create(Component.class)`:
+
image::release_notes/v-14-uicomp-create.gif[align="center"]

. В дизайнер экранов добавлена поддержка метаданных сторонних UI компонентов. Это позволяет вам сынтегрировать сторонний UI компонент, реализованный в аддоне или в вашем проекте, в интерфейс дизайнера экранов, добавляя особые аннотации к определению компонента. Подробная информация о UI метаданных доступна в {main_man_url}/own_component_in_studio.html[Руководстве по разработке приложений].

. Добавлена интеграция с {cuba-store-site}[CUBA Store]. Теперь вы можете залогиниться в свой профиль CUBA , нажав кнопку *CUBA User Profile*, расположенную на панели инструментов:
+
image::release_notes/v-14-login-cuba-account.png[align="center"]
+
После входа в профиль вам станет доступным автоматическое скачивание и установка триальных версий коммерческих аддонов в окне *Marketplace*.

. Время работы команды *Generate Database Scripts* было существенно оптимизировано (снижено). То же проделано с проверкой соответствия схемы БД и модели данных, проводимой перед запуском конфигурации запуска *CUBA Application*.

. Studio теперь использует драйвер MariaDB для подключения к базам данных MySQL и MariaDB. Больше не требуется скачивать закрытый драйвер MySQL, чтобы использовать MySQL вместе со Studio. Если вам необходимо использовать именно драйвер MySQL по какой-то причине, он может быть включен, если добавить параметр `disableMariaDbDriver` к строке подключения.

. Настройки памяти JVM по умолчанию для отдельной Studio IDE были увеличены. Теперь она настроена на использование до `-Xmx1200m` вместо предыдущего значения `-Xmx768m`.

. Версия Studio, устанавливаемая как отдельная IDE, обновлена до платформы IntelliJ Community *2019.3*. Если у вас уже была установлена отдельная Studio IDE, то она не будет обновлена; вам следует скачать новую версию с сайта {cuba-download-site}[CUBA Platform].

. Реализация браузера через JxBrowser была удалена. Теперь Studio использует JavaFX для показа внутренних веб-страниц. Это помогло существенно сократить размер сборки плагина.

. Прочие небольшие улучшения и исправления:

** pass:macros[https://youtrack.cuba-platform.com/issues/STUDIO?q=Fixed%20in%20builds:%2014.3[Studio 14.3 Resolved Issues\]]
** pass:macros[https://youtrack.cuba-platform.com/issues/STUDIO?q=Fixed%20in%20builds:%2014.1[Studio 14.1 Resolved Issues\]]
** pass:macros[https://youtrack.cuba-platform.com/issues/STUDIO?q=Fixed%20in%20builds:%2014.0[Studio 14.0 Resolved Issues\]]

--
