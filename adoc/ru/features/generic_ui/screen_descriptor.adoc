:sourcesdir: ../../../../source

[[screen_descriptor]]
==== Работа с дескриптором экрана

Редактор {main_man_url}/screen_descriptors.html[XML-дескриптора экрана] содержит две вкладки: *Text* и *Designer*. На вкладке *Text* вы можете редактировать код XML напрямую, а вкладка *Designer* позволяет работать с экраном в визуальном редакторе разметки.

Переключаться между дескриптором и контроллером экрана можно с помощью специального маркера в жёлобе Studio. Также вы можете выбрать дескриптор в дереве проекта и в его контекстном меню нажать *Go to controller* или  выбрать действие *Controller* из верхней панели действий.

[[screen_descriptor_actions_panel]]
Верхняя панель действий::
+
--
Панель действий расположена в верхней части редактора исходного кода. Она содержит следующие действия:

* *Controller* - перейти к контроллеру экрана.
* *Preview* - открыть окно с предварительным просмотром верстки редактируемого экрана. Рабочая область окна предпросмотра взаимодействует с редактором XML и автоматически обновляет содержимое в соответствии с изменениями верстки. Это действие доступно только в случае активной подписки.
* *<название класса сущности>* - отображается, если данный экран является экраном просмотра/выбора или редактором сущности. Позволяет перейти к классу сущности, связанной с данным экраном.
--

[[screen_descriptor_inspections]]
Статический анализ кода (Inspections)::
+
--
Studio непрерывно проводит фоновый статический анализ кода разметки экрана на предмет ошибок и несоответствий, проверяет внутренние и внешние ссылки. В случае обнаружения следующих проблем Studio покажет специальное предупреждение или подчеркнёт проблемный элемент в XML-коде:

* Экран не может быть собран из-за ошибки в разметке XML.
* Ссылка на сущность или её свойство, используемая компонентом, не соответствует реальной модели данных приложения.
* Есть конфликт размеров компонентов: учитываются значения атрибутов `width`, `height` и `expand`.
* Значения атрибутов `dataContainer` и `dataLoader` не ссылаются ни на один из имеющихся контейнеров или загрузчиков.
* Для полей внутри элемента `form` явно не определён XML-атрибут `property`: в этом случае для ссылки на поле сущности будет неявно использовано значение атрибута `id`.
* Семантическая ошибка в элементе `form`: поля дублируются или располагаются не внутри вложенного элемента `column`.
* Количество столбцов `gridLayout` не соответствует заявленному количеству.
* Дублирование атрибута в расширенном экране, когда один и тот же атрибут объявлен и в родительском, и в дочернем экране.
* Имена элементов в дочернем экране не соответствуют аналогичным элементам в родительском экране, либо их расположение некорректно.
* Значение атрибута `messagesPack` не ссылается на реально существующий пакет сообщений, содержащий как минимум один файл `messages_xx.properties`.
* Ссылка на схему XSD устарела.
* Значения идентификаторов элементов не уникальны внутри данного экрана.
* и другие проблемы.

Инспекции CUBA можно настроить в окне *Settings* (*File > Settings > Editor > Inspections*).
--

[[screen_descriptor_intentions]]
Намерения (Intentions) и меню Generate::
+
--
Intention-действие ("намерение") - это контекстно зависимое действие (зависит от позиции курсора), которое может быть запущено разработчиком из редактора исходного кода по нажатию Alt+Enter (Option+Enter). Intention-действия помогают с рефакторингами, генерацией кода, навигацией по коду и другими задачами. Вы можете прочитать больше об intention-действиях здесь: https://www.jetbrains.com/help/idea/intention-actions.html.

Меню *Generate* содержит контекстно зависимые действия, помогающие генерировать различные конструкции кода. Это меню может быть вызвано из редактора исходного кода нажатием Alt+Insert (Cmd+N). Дополнительная информация об этом меню находится здесь: https://www.jetbrains.com/help/idea/generating-code.html.

Многие intention-действия и элементы меню Generate, встроенные в Studio, помогают работать с компонентами экранов. Используйте Alt+Insert (Cmd+N) и Alt+Enter (Option+Enter), чтобы исследовать возможности работы с конкретными компонентами UI и источниками данных. Например, чтобы добавтиь нвоое поле в компонент {main_man_url}/gui_Form.html[Form], вы можете поместить курсор во внутрь элемента `form` и выполнить одно из следующих действий:

* Нажать Alt+Insert (Cmd+N), выбрать *Add field*, а затем выбрать значение атрибута `property`,
+
image::features/generic_ui/gui_Form_add.png[align="center"]

* Ввести `field` и нажать TAB, затем выбрать значение атрибута `property`.
+
image::features/generic_ui/gui_Form_add_tab.png[align="center"]
--

[[screen_descriptor_designer]]
Дизайнер экранов::
+
--
На вкладке *Designer* отображается визуальный дизайнер, который позволяет создавать компоновку экрана и задавать свойства компонентов UI в стиле WYSIWYG.

image::features/generic_ui/screen_designer.png[align="center"]

Рабочая область дизайнера включает в себя четыре панели:

* *Canvas* - рабочая область, в которой вы можете располагать компоненты, а также изменять их размер и задавать выравнивание с помощью кнопок:
** расширить горизонтально,
** расширить вертикально,
** выровнять по вертикали/горизонтали.

* *Palette* - палитра, содержащая набор доступных экранных компонентов:
** Контейнеры;
** Компоненты;
** Компоненты данных: контейнеры и загрузчики;
** Не-визуальные компоненты: действия, настройки диалогового окна, таймеры.

Чтобы добавить компонент на экран, перетащите его из палитры в панель иерархии компонентов.

* *Hierarchy* - панель иерархии компонентов, отображающая использованные в экране компоненты в виде дерева. Элементы дерева можно перетаскивать с места на место. Вы можете удалять, копировать, вырезать или вставлять элементы в дерево иерархии с помощью его контекстного меню, открываемого по клику правой кнопки мыши.

* *Properties* - панель, отображающая свойства конкретного визуального компонента.

* *Handlers* - панель, отображающая слушатели событий и методы-делегаты, которые могут быть созданы для выбранного в дереве иерархии компонента. Чтобы сгенерировать необходимый метод-обработчик - просто выполните двойной клик по соответствующей строчке.
--
