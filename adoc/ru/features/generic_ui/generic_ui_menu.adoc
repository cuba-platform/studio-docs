:sourcesdir: ../../../../source

[[generic_ui_menu]]
==== Работа с меню приложения
--
Конфигурация меню приложения хранится в файле `web-menu.xml`, расположенном в web-модуле проекта. Чтобы изменить конфигурацию главного меню, используйте пункт *Generic UI* -> *Main Menu* в дереве проекта CUBA:

image::features/generic_ui/main_menu_in_tree.png[align="center"]

Дизайнер меню позволяет визуально настраивать структуру главного меню приложения. На вкладке *Structure* вы найдёте графический дизайнер меню, а его XML-код можно редактировать на вкладке *Text*.

image::features/generic_ui/web_menu.png[align="center"]

[TIP]
====
Дизайнер главного меню доступен только для пользователей с активной подпиской CUBA Studio.
====
--

Режимы структуры главного меню::
--
Существует два режима создания меню:

* Режим *Single mode* содержит только элементы, описанные в файле `web-menu.xml`. В этом режиме вам придётся вручную создавать все элементы меню, включая те, что были созданы в компонентах приложения. С другой стороны, этот режим предоставляет вам полный контроль над структурой меню.

* Режим *Composite mode* включает в себя все элементы, описанные в файле `menu.xml` проекта, плюс элементы из конфигурационных файлов меню компонентов приложения. Этот режим позволяет легко использовать все унаследованные элементы и добавить к ним элементы, специфичные для данного проекта, в любое место в структуре меню. Унаследованные элементы отредактировать нельзя.
+
Дополнительно на вкладке *Text* можно определить для элементов меню атрибуты `ìnsertBefore` и `insertAfter`, которые указывают, где должен быть размещён конкретный элемент меню. Эти атрибуты позволяют комбинировать элементы меню текущего проекта с элементами, унаследованными из компонентов, если выбран режим *Composite*.
+
Например, если вы хотите поместить собственную структуру меню слева от стандартного элемента _Administration_, установите атрибут `insertBefore="administration"` для корневого элемента в вашей иерархии.
+
В визуальном дизайнере вы можете просто перетаскивать (drag-and-drop) пункты меню в дереве, чтобы изменить их позицию в структуре меню.

Список конфигурационных файлов меню задаётся свойством приложения {main_man_url}/app_properties_reference.html#cuba.menuConfig[cuba.menuConfig], значение которого обновляется при смене режима создания меню.

Когда вы переключаете меню из режима *Composite* в режим *Single*, Studio предлагает вам сохранить пункты меню, унаследованные из платформы и аддонов:

image::features/generic_ui/menu_switch_mode_single.png[align="center"]

Если вы решите сохранить унаследованные пункты, их структура будет скопирована в ваш проект, и вы сможете изменять их так, как необходимо (например добавить иконки, изменить подписи).

Если позднее вы решите переключить главное меню обратно в режим *Composite*, имейте ввиду, что вам нужно будет вручную удалить все дублированные разделы и пункты меню из конфигурации вашего проекта. Иначе меню окажется неработоспособным, т.к. структура меню не позволяет иметь дубликаты.
--

Добавление пунктов меню::
--
Чтобы добавить в меню новый элемент, выберите существующий элемент (или файл конфигурации, если нужно создать элемент верхнего уровня) и нажмите на кнопку image:plus_button.png[+]. Появится окно *Menu Item editor*, в котором вы можете создать элемент меню с одним из следующих типов:
--

Screen::
+
--
image::features/generic_ui/web_menu_create.png[float="right"]

Элемент меню, открывающий экран приложения.

Для элемента *Screen* специфичны следующие свойства:

* *Screen* - неуникальный идентификатор экрана, который должен открывать этот элемент.
* *Open type* - свойство, определяющее, как должен открываться экран: в новой вкладке или в виде модального окна (`NEW_TAB` или `DIALOG`). По умолчанию используется `NEW_TAB`.
--

Menu::
+
--
image::features/generic_ui/web_menu_create_2.png[align="center"]

Раздел меню, содержащий другие элементы меню (подменю).
--

Bean::
+
--
Элемент меню, который вызывает определённый метод {main_man_url}/managed_beans.html[управляемого бина]. Этот бин должен находиться в *web* модуле проекта.

Для элемента *Bean* специфичны следующие свойства:

* *Bean* - имя бина, которое можно получить с помощью `AppBeans` (к примеру, `cuba_Messages`).
* *Bean method* - имя метода бина.

image::features/generic_ui/web_menu_create_3.png[align="center"]

--

Class::
+
--
image::features/generic_ui/web_menu_create_4.png[float="right"]

Элемент меню, который выполняет метод определённого класса.

Для элемента *Class* специфичны следующие свойства:

* *Class* - полное имя класса, который реализует один из поддерживаемых интерфейсов:
** `java.lang.Runnable`,
** `java.util.function.Consumer<Map<String, Object>>`
** или `com.haulmont.cuba.gui.config.MenuItemRunnable`.
--

Separator::
--
Горизонтальная линия, разделяющая элементы меню.
--

Общие параметры::
--
Следующие параметры доступны для разных видов элементов меню:

* *Menu item* - родительское меню или подменю, куда нужно поместить новый пункт.
* *Id* - произвольный уникальный идентификатор элемента. Этот атрибут необязателен, однако рекомендуется его присвоить, если вы планируете {main_man_url}/gui_AppMenu.html[динамически управлять конфигурацией меню].
* *Caption* - локализованная подпись элемента. Нажав кнопку "глобус", вы можете открыть диалог *Localized Message* и задать локализованные подписи для всех поддерживаемых локалей.
* *Shortcut* - горячие клавиши для открытия данного экрана. Допустимые модификаторы (ALT, CTRL, SHIFT) разделяются символом "-", например, ALT-C.
* *Style name* - определяет имя стиля элемента, подробнее см. в разделе {main_man_url}/gui_themes.html[Темы приложения] основного руководства.

Следующие параметры становятся доступными для редактирования на правой панели дизайнера после того, как пункт меню создан:

* *Icon* - иконка элемента.
* *Description* - локализованный текст, показываемый как всплывающая подсказка при наведении указателя мыши. Нажав кнопку "глобус", вы можете открыть диалог *Localized Message* и ввести локализованные описания для всех поддерживаемых локалей.
* *Params* - Параметры экрана, которые будут передаваться в метод `init()` при открытии контроллера экрана.
* *Permissions* - дает возможность ограничить доступ к элементу меню. Если пользователь не имеет разрешений для доступа к элементу, он не отображается. Заметьте, что есть более простой способ управления доступом - с помощью разрешений на экраны в ролях.

Для более подробного описания упомянутых параметров обратитесь к {main_man_url}/menu.xml.html[Руководству по разработке].
--
