[[relnotes_13]]

Версия 13::
+
--
Компоновка дизайнера экранов была переработана, при этом преследовались следующие цели:

* Эффективное использование пространства окна IDE.
* Удобное переключение между исходным кодом XML дескриптора и панелью предварительного просмотра верстки.
* Позволить опытным разработчикам использовать возможности дизайнера при просмотре и редактировании XML кода.

В дизайнере экранов проделаны следующие изменения и улучшения:

. Панели дизайнера стали независимыми панелями IDE (tool window). *Component Hierarchy* - осталась в верхнем правом углу IDE, как и раньше. *Component Palette* отображается в нижнем правом углу. *Component Inspector* отображается в нижнем левом углу и содержит вкладки *Properties* и *Handlers*.
+
Эти панели автоматически появляются, когда вы открываете дескриптор экрана в редакторе. Когда вы переключаетесь в редакторе на другой экран, содержимое панелей обновляется. Иногда, когда вы открываете другие панели IDE (такие как Gradle, Persistence и т.д.), панели дизайнера экранов скрываются, и потом их нужно будет переоткрыть, используя соответствующие кнопки на левой и правой кромках окна IDE.
+
Сохранилась возможность отображения панели *Component Inspector* в правом нижнем углу для тех пользователей, кто предпочитает старую компоновку. Чтобы переместить эту панель на правую сторону окна, используйте кнопку *Move to Right Bottom*, расположенную в заголовке панели.
+
image::release_notes/v-13-sd-tool-windows.png[align="center"]

. Панель предпросмотра верстки теперь разделяет пространство редактора с исходным кодом дескриптора экрана. Вкладки *Text* и *Designer* ушли в прошлое. Справа, на верхней панели редактора дескриптора экрана теперь расположены четыре кнопки, переключающие режим отображения предпросмотра:
.. *Editor only* - редактор содержит только исходный код.
.. *Editor and Preview* -  пространство редактора разделено пополам между исходным кодом и панелью предпросмотра.
.. *Preview only* - весь редактор занят панелью предпросмотра (как было раньше в дизайнере экранов).
.. *Preview in Window* - редактор содержит исходный код, а панель предпросмотра выделена в независимое окно, которое можно переместить на другой монитор.

. Панели дизайнера активны и взаимодействуют с редактором XML кода. Опытные разработчики, которые просматривают и редактируют верстку экранов путем прямого редактирования XML кода, теперь могут воспользоваться всеми возможностями быстрой генерации кода в дизайнере экранов:
.. Панели дизайнера *Component Hierarchy* и *Component Inspector* следят за курсором в XML коде и выбирают соответствующий компонент, когда курсор переходит от одного тега к другому.
.. При выборе элемента в панели иерархии - курсор перемещается к соответствующему XML тегу в исходном коде.
.. Вы можете добавлять компоненты из палитры в панель иерархии, переупорядочивать компоненты и редактировать свойства компонентов в панели *Component Inspector*, когда в редакторе открыт исходный код. Все изменения немедленно применяются к исходному коду.

. Дизайнер экранов теперь отображает столбцы и действия компонентов типа `Table` (и `DataGrid`) в дереве *Component Hierarchy*. Кроме того были удалены несколько модальных диалогов, которые ранее использовались для редактирования столбцов и действий. Теперь вы можете просматривать и редактировать свойства столбцов и действий, а также их обработчики событий, прямо в панели *Component Inspector*. Добавлять новые столбцы и действия в таблицу тоже стало удобнее.  Когда в дизайнере выбрана таблица, одна из её колонок или действий, то в панели *Component Inspector* отображается кнопка *+ Add*. Нажав её, можно добавить один или несколько столбцов или действий в таблицу.

. В дизайнер экранов добавлены диалоги-помощники создания компонентов. Добавлять контейнеры данных, таблицы и гриды, столбцы и действия таблиц, поля форм в экраны стало проще.
+
При добавлении одного из упомянутых компонентов в экран, появляется диалог, позволяющий сразу задать основные необходимые для функционирования компонента свойства. Например, при добавлении в экран компонента `DataGrid`, можно выбрать существующий или создать новый контейнер данных, указать id компонента и выбрать набор действий с кнопками, которые будут сразу добавлены к таблице.
+
image::release_notes/v-13-datagrid-wizard.png[align="center"]

. В панель дизайнера *Component Hierarchy* добавлена возможность поиска компонента по строке:
+
image::release_notes/v-13-search-hierarchy.png[align="center"]

. В контекстное меню панели *Component Hierarchy* добавлены дополнительные конвертации. Теперь можно быстро сконвертировать компонент `TextField` в `TextArea` и другие компоненты:
+
image::release_notes/v-13-text-field-conversions.png[align="center"]

. Действие контекстного меню *Inject to Controller*, доступное в панели *Component Hierarchy*, теперь позволяет инжектировать несколько выбранных компонентов за раз.

Другие добавленные возможности и улучшения:

. Добавлена поддержка языка программирования https://kotlinlang.org[Kotlin]. Вы можете выбрать Kotlin как основной язык программирования проекта в мастере создания проекта, если выбрана версия платформы `7.2.0` или выше. Все элементы CUBA проекта: сущности, экраны, сервисы - генерируются с использованием Kotlin. Визуальные дизайнеры Studio, автодополнения, инспекции и мгновенное применение изменений также поддерживают Kotlin.

. Был переработан механизм мгновенного применения изменений к отладочному серверу (*Hot Deploy*) для проектов, использующих версию платформы `7.2.0` или выше (для всех языков программирования), чтобы поддержать язык Kotlin. Если вы столкнетесь с какими-либо проблемами в Java / Groovy проектах, вы можете переключиться на старый режим применения изменений, выключив следующую настройку: главное меню -> *CUBA* -> *Settings* -> *Project Settings* -> *Hot deploy compiled classes*.

. Расширен мастер создания CUBA проектов. Были перегруппированы поля между шагами мастера, и добавлена возможность сразу задать следующие настройки проекта: префикс названия модулей, поддерживаемые языки программирования, локали, настройки главного хранилища данных.

. К конфигурации запуска *CUBA Application* были добавлены две настройки: аргументы командной строки (command line arguments) и переменные среды (environment variables). Эти настройки применяются к процессу Tomcat, который выполняет CUBA приложение в режиме отладки. Например, указав аргументы командной строки, можно задать часовой пояс: `-Duser.timezone=Europe/London` или увеличить доступную память: `-Xmx1500m` для сервера приложения.
+
image::release_notes/v-13-run-configuration.png[align="center"]

. Добавлен новый шаблон экрана входа в систему (login) с обновленными компоновкой и дизайном. Этот шаблон доступен для проектов, основанных на версии платформы `7.2.0` или выше. Примеры, как новый экран входа выглядит, можно посмотреть здесь: https://github.com/cuba-platform/cuba/issues/2455[Тикет GitHub]. Чтобы добавить новый экран входа в ваш проект, выберите шаблон *Login screen with branding image* в мастере создания экранов *New* -> *Screen*.

. В диалог *Project Properties* добавлена возможность менять версию проектных артефактов сборки:
+
image::release_notes/v-13-artifact-version.png[align="center"]

. Действие *Inject* добавлено в верхнюю панель действий для редактора исходного кода сервисов среднего слоя и Spring бинов. Ранее оно было доступно только через меню Generate (Alt+Insert).

. Добавлен удобный диалог для задания параметров подключения в окне *Data Store Properties*. К полю *Connection params* добавлена кнопка "карандаш", нажатие этой кнопки открывает диалог, позволяющий ввести параметры подключения. Studio конвертирует параметры в строку подключения, используя разделительные символы конкретной СУБД:
+
image::release_notes/v-13-connection-params.png[align="center"]

. Диалог *Locales* теперь подсказывает доступные языки и страны и автоматически заполняет код локали соответственно выбранному языку и стране:
+
image::release_notes/v-13-locales-dialog.png[align="center"]

. Инспекция кода *Attribute is not included into the view* была расширена. Теперь она также проверяет использования неперсистентных атрибутов, которые имеют связанные персистентные атрибуты, указанные в параметре аннотации `@MetaProperty#related`.

. Улучшено поведение Studio для проблемных ситуаций, когда синхронизация проекта Gradle по какой-то причине завершается ошибкой. Главное меню *CUBA* теперь остается видимым и содержит следующие дополнительные пункты:
.. Пункт *Re-Import Gradle Project* может помочь в случае однократной проблемы недоступности сети.
.. Пункт *Restore Project to the Latest State* откатывает содержимое скриптов сборки Gradle до состояния, соответствующего последнему успешному импорту, и это позволяет исправить ситуацию в случае нечаянных или ошибочных изменений в скриптах сборки.
+
image::release_notes/v-13-menu-import-failed.png[align="center"]

.  Версия Studio, устанавливаемая как отдельная IDE, обновлена до платформы IntelliJ Community *2019.2*.
Если у вас уже была установлена отдельная Studio IDE, то она не будет обновлена; вам следует скачать новую версию с сайта {cuba-download-site}[CUBA Platform].

. Прочие небольшие улучшения и исправления:

** pass:macros[https://youtrack.cuba-platform.com/issues/STUDIO?q=Fixed%20in%20builds:%2013.0[Studio 13.0 Resolved Issues\]]

--
